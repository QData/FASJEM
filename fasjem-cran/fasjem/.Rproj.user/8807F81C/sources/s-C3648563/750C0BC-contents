library(fasjem)


data(exampleData)

### run fasjem algorithm to estimate two sparse precision matrices from example data

exampleresult = fasjem(X = exampleData, method = "fasjem-g", 0.5, 0.1, 0.1, 0.05, 10)
examplegraph = returngraph.fasjem(exampleresult)
examplelayout = layout_nicely(examplegraph,dim=2)


### multiple display
par(mfrow=c(2,2))

### test for graph and single subID
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = 0, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = 1, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = 2, graphlayout = examplelayout)
}

### test for graph and single invalid subID
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = 3, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = 4, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = "hello", graphlayout = examplelayout)

}

### test for graph and multiple valid subID
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(0,1), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(2,1), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(0,2), graphlayout = examplelayout)
}

### test for graph and multiple unusual valid subID
### all three should pass
{
  ### get rid of redundency
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(0,0,0,0), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(2,1,1), graphlayout = examplelayout)
  ### task graph c(1:K) is all graphs but will display task graph 1,2
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(0,1,2,2), graphlayout = examplelayout)
}

### test for graph and multiple invalid subIDs
### all three shouldn't pass
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(0,1,3), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(2,1,3), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", subID = c(-1,2), graphlayout = examplelayout)
}

### test for share
### all three should pass (subID and index don't matter)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="share", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="share", subID = c(0,1,3), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="share", subID = c(2,1,3), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="share", subID = c(-1,2), graphlayout = examplelayout)
}


### test for task specific, single subID
### the last one shouldn't pass (invalid subID)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = 1, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = 2, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = 0, graphlayout = examplelayout)
}

### test for task specific, multiple subID
### all should pass
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = c(2,1), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = c(1,1), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = c(1,2,2,2), graphlayout = examplelayout)
}

### test for task specific, multiple subID
### all shouldnt pass
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="graph", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = c(0,1), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = c(-1,1), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="taskspecific", subID = c(1,3), graphlayout = examplelayout)
}






### both valid
### one invalid / on valid
### both invalid
### test for neighbour


### task with single index, single subID (valid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = 6, subID = 1, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = 17, subID = 0, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = 20, subID = 2, graphlayout = examplelayout)

}


### task with single index, single subID (invalid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = 30, subID = 1, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = 17, subID = 3, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = -20, subID = -1, graphlayout = examplelayout)

}



### task with multiple index, multiple subID (valid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(15,20), subID = c(0,1,2), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(8,6,4,3,3,3), subID = c(0,1), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(15,20), subID = c(1,2), graphlayout = examplelayout)

}


### task with multiple index, multiple subID (valid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(15,20), subID = c(0,1,2), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(8,6,4,3,3,3), subID = c(0,1), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(15,20), subID = c(1,2), graphlayout = examplelayout)

}


### task with multiple index, multiple subID (invalid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(31,15,20), subID = c(0,1,2), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(8,6,4,3,3,3), subID = c(0,1,3), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "task",
              index = c(15,20), subID = c(-1,1,2), graphlayout = examplelayout)

}


### test for default option for zoom in nodes on all graphs
plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour",
            index = c(15,20), graphlayout = examplelayout)


### task specific with single index, single subID (valid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = 1, index = 6, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = 2, index = 17, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = 2, index = 20,graphlayout = examplelayout)
}

### task specific with single index, single subID (invalid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = 1, index = 30, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = 0, index = 17, graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = 3, index = 20,graphlayout = examplelayout)
}


### task specific with multiple index, multiple subID (valid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = c(1,2), index = c(6,8), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = c(2,1), index = c(1,3), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = c(1,2), index = c(19,20),graphlayout = examplelayout)
}


### task specific with multiple index, multiple subID (invalid)
{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="task", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = c(0,1,2), index = c(6,8), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = c(2,1), index = c(1,3,30), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = c(1,2), index = c(19,20,-1),graphlayout = examplelayout)
}



### test for some general invalid options

{
  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="h", graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = c(1,2), index = c(6,8), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "l",
              subID = c(2,1), index = c(1,3), graphlayout = examplelayout)

  plot.fasjem(exampleresult, option = "2D", graphlabel = NULL, type="neighbour", neighbouroption = "taskspecific",
              subID = c(1,2), index = c(19,20),graphlayout = examplelayout)
}
